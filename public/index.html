<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>Ω: Omega Issue Tracker</title>
	<link rel="stylesheet" href="css/omega.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.js"></script>
	<script src="/socket.io/socket.io.js"></script>
	<script src="js/jquery.tmpl.js"></script>
	<script src="js/knockout-1.2.1.js"></script>
	<script src="js/underscore-1.1.7.js"></script>
	<script src="js/omega.js"></script>
</head>
<body>
<div id="header">
	<h1>Ω</h1><div id="loggedInUser" data-bind="text: user"></div>
</div>
<ul id="messages" data-bind="template: {name: 'messageItemTemplate', foreach: messages}">
</ul>
<form id="form" action="">
	<input id="input" type="text" name="text" placeholder="Type commands (like '/help') or just chat it up"/>
</form>
<dl id="commandList" data-bind="visible: helpOpen, click: function() { helpOpen(false); $inputBox.focus(); }">
	<dt>/create &lt;description&gt;</dt>
	<dt>/assign &lt;id&gt; [&lt;user&gt;]</dt>
	<dt>/unassign &lt;id&gt;</dt>
	<dt>/edit &lt;id&gt; &lt;description&gt;</dt>
	<dt>/close &lt;id&gt;</dt>
</dl>

<div id="issuesContainer">
	<label class="hideIssues"><input type="checkbox" data-bind="checked: hideClosed"/> Hide closed</label>
	<h2>Issues</h2>
	<ul id="issuesList" data-bind="template: {name: 'issueItemTemplate', foreach: issues, templateOptions: { hideClosed: hideClosed }}">
	</ul>
</div>

<script type="text/x-jquery-tmpl" id="messageItemTemplate">
	<li>{{= user}} says: {{= msg}}</li>
</script>
<script type="text/x-jquery-tmpl" id="issueItemTemplate">
	<li data-bind="visible: !($item.hideClosed() && closed()), css: { closed: closed }">Ω{{= id}} <span class="assignee" data-bind="text: assignee() != 'nobody' ? '(@' + assignee() + ')' : ''"></span> {{= description}}</li>
</script>

<script type="text/javascript">
var socket = io.connect();
var tracker; // for debugging
$(function () {
	tracker = new OmegaIssueTracker.Tracker($("#input"), $("#form"), socket);
});
</script>
</body>
</html>
